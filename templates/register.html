{% extends 'base.html' %} {% block title %}Register{% endblock %} {% block
  content %}
  
  <!--tp-contact-start-->
  <!-- faq area start -->
  <div class="tp-faq-area pt-130 pb-140">
    <div class="container">
      <div class="row align-items-end">
        <div class="col-xl-5 col-lg-5 pb-200">
          <div class="tp-faq-title-box mb-80">
            <span class="tp-section-2-subtitle mb-20 text-light"
              > a question?</span
            >
            <h4
              class="text-light tp-section-title fs-40 tp-split-text tp-split-right"
            >
              We are the ones who make the impossible possible.
            </h4>
          </div>
          <div class="tp-faq-wrapper">
            <div class="accordion" id="accordionExample">
              <div class="accordion-items">
                <h2 class="accordion-header">
                  <button
                    class="accordion-buttons collapsed text-light"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseOne"
                    aria-expanded="true"
                    aria-controls="collapseOne"
                  >
                  How It Works
                    <span class="accordion-icon"></span>
                  </button>
                </h2>
                <div
                  id="collapseOne"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionExample"
                >
                  <div class="accordion-body text-light">
                    <p class="text-light">
                      Upload or Capture: Choose an image from your device or capture a new photo using your camera.
                    </p>
                  </div>
                </div>
              </div>
              <div class="accordion-items">
                <h2 class="accordion-header">
                  <button
                    class="accordion-buttons collapsed text-light"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseTwo"
                    aria-expanded="false"
                    aria-controls="collapseTwo"
                  >
                  Automatic Analysis
                    <span class="accordion-icon text-light"></span>
                  </button>
                </h2>
                <div
                  id="collapseTwo"
                  class="accordion-collapse collapse"
                  data-bs-parent="#accordionExample"
                >
                  <div class="accordion-body text-light">
                    <p class="text-light">
                      Our intelligent system processes the image, detecting and recognizing faces with high precision.
                    </p>
                  </div>
                </div>
              </div>
              <div class="accordion-items">
                <h2 class="accordion-header">
                  <button
                    class="accordion-buttons collapsed text-light"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseThree"
                    aria-expanded="false"
                    aria-controls="collapseThree"
                  >
                  Instant Feedback
                    <span class="accordion-icon"></span>
                  </button>
                </h2>
                <div
                  id="collapseThree"
                  class="accordion-collapse collapse text-light"
                  data-bs-parent="#accordionExample"
                >
                  <div class="accordion-body text-light">
                    <p class="text-light">
                      Our tools are easy to use and affordable, so you can start
                      improving your website's SEO today.
                    </p>
                  </div>
                </div>
              </div>
              <div class="accordion-items">
                <h2 class="accordion-header">
                  <button
                    class="accordion-buttons collapsed text-light"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseFour"
                    aria-expanded="false"
                    aria-controls="collapseFour"
                  >
                  Unlock the Power of Face Recognition
                    <span class="accordion-icon"></span>
                  </button>
                </h2>
                <div
                  id="collapseFour"
                  class="accordion-collapse collapse text-light"
                  data-bs-parent="#accordionExample"
                >
                  <div class="accordion-body text-light">
                    <p class="text-light">
                      we are at the forefront of face recognition technology, providing you with a cutting-edge solution for accurate, efficient, and secure identity verification. Our system is designed to meet the needs of modern applications, offering a blend of advanced technology and user-friendly features.
                    </p>
                  </div>
                </div>
              </div>
              <div class="accordion-items">
                <h2 class="accordion-header">
                  <button
                    class="accordion-buttons collapsed text-light"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseFive"
                    aria-expanded="false"
                    aria-controls="collapseFive"
                  >
                  Key Features
                    <span class="accordion-icon"></span>
                  </button>
                </h2>
                <div
                  id="collapseFive"
                  class="accordion-collapse collapse text-light"
                  data-bs-parent="#accordionExample"
                >
                  <div class="accordion-body text-light">
                    <p class="text-light">
                      igh Precision Recognition: Our system accurately detects and matches faces, even in challenging conditions such as varying lighting and angles
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-7 col-lg-7">
          <div class="tp-faq-form-box">
            <div class="tp-faq-form-wrap">
              <div class="tp-faq-form-content mb-45">
                <h4 class="tp-faq-form-title mb-10 text-dark">
                  Claim Your Complimentary SEO Analysis Today!
                </h4>
                <p class="text-dark">
                  Get help from a team of experts if you need it
                </p>
              </div>
              <form
    action="{{ url_for('register') }}"
    method="post"
    enctype="multipart/form-data"
  >
    <div class="row">
      <div class="col-xl-12">
        <div class="team-details-input text-light mb-20">
          <label class="text-dark">Name</label>
          <input name="name" type="text" placeholder="Your name" />
          {% if errors and errors.get('name') %}
          <div class="text-danger">{{ errors['name'] }}</div>
          {% endif %}
        </div>
      </div>

      <div class="col-xl-12">
        <label class="text-dark">Upload Image:</label>
        <div id="upload-area" class="file-upload">
          Drag & Drop or Click to Upload Image
        </div>
        <input
          type="file"
          id="file-input"
          name="image"
          accept="image/*"
          style="display: none;"
        />
        <img
          id="preview"
          src=""
          alt="Image preview"
          style="display: none;"
        />
        {% if errors and errors.get('image') %}
        <div class="text-danger">{{ errors['image'] }}</div>
        {% endif %}
      </div>

 

      <div class="col-xl-12">
        <label class="text-dark">Or Capture Image:</label>
        <label class="switch">
          <input type="checkbox" id="capture" />
          <span class="slider"></span>
        </label>
      </div>


      <label class="text-dark" for="capture">Capture from Live Camera</label>
      <input type="hidden" id="camera-image-data" name="camera_image_data" />

      <div class="col-xl-12">
        <div class="team-details-btn">
          <button
            type="submit"
            class="tp-btn-blue radius-6 w-100 text-center text-light"
          >
            Submit
          </button>
        </div>
      </div>
    </div>
  </form>
            
         
            
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- faq area end -->
  <!-- <h2>Register New User</h2>
    <form
      action="{{ url_for('register') }}"
      method="post"
      enctype="multipart/form-data"
    >
      <div class="forms -group">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required />
      </div>
      <div class="forms -group">
        <label>Upload Image:</label>
        <div id="upload-area" class="file-upload">
          Drag & Drop or Click to Upload Image
        </div>
        <input type="file" id="file-input" name="image" accept="image/*" />
        <img id="preview" src="" alt="Image preview" style="display: none" />
      </div>
      <div class="forms -group">
        <label>Or Capture Image:</label>
        <input type="radio" id="capture" name="capture" value="capture" />
        <label for="capture">Capture from Live Camera</label>
      </div>
      <button type="submit">Register</button>
    </form> -->
    <script>
     document.addEventListener("DOMContentLoaded", function () {
    const captureCheckbox = document.getElementById("capture");
    const fileInput = document.getElementById("file-input");
    const uploadArea = document.getElementById("upload-area");
    const previewImage = document.getElementById("preview");
    const videoPreview = document.createElement("video");
    const cameraImageData = document.getElementById("camera-image-data");
    const canvas = document.createElement("canvas");
    const context = canvas.getContext("2d");

    videoPreview.setAttribute("id", "video-preview");
    videoPreview.setAttribute("width", "100%");
    videoPreview.setAttribute("height", "auto");
    videoPreview.setAttribute("autoplay", true);
    videoPreview.style.display = "none";

    uploadArea.parentNode.insertBefore(videoPreview, uploadArea.nextSibling);

    function startVideoStream() {
        navigator.mediaDevices
            .getUserMedia({ video: true })
            .then((stream) => {
                videoPreview.srcObject = stream;
                videoPreview.style.display = "block";
                uploadArea.style.display = "none";
                previewImage.style.display = "none";
            })
            .catch((error) => {
                console.error("Error accessing the camera", error);
            });
    }

    function stopVideoStream() {
        const stream = videoPreview.srcObject;
        if (stream) {
            const tracks = stream.getTracks();
            tracks.forEach((track) => track.stop());
        }
        videoPreview.style.display = "none";
        uploadArea.style.display = "block";
        fileInput.value = "";
    }

    captureCheckbox.addEventListener("change", function () {
        if (this.checked) {
            startVideoStream();
        } else {
            stopVideoStream();
        }
    });

    fileInput.addEventListener("change", function () {
        if (this.files && this.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
                previewImage.src = e.target.result;
                previewImage.style.display = "block";
                videoPreview.style.display = "none";
                cameraImageData.value = ""; // Clear camera data if file is selected
            };
            reader.readAsDataURL(this.files[0]);
        }
    });

    uploadArea.addEventListener("dragover", function (e) {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.classList.add("drag-over");
    });

    uploadArea.addEventListener("dragleave", function (e) {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.classList.remove("drag-over");
    });

    uploadArea.addEventListener("drop", function (e) {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.classList.remove("drag-over");

        const files = e.dataTransfer.files;
        if (files.length > 0) {
            fileInput.files = files; // Update file input with dropped files
            const reader = new FileReader();
            reader.onload = function (e) {
                previewImage.src = e.target.result;
                previewImage.style.display = "block";
                videoPreview.style.display = "none";
                cameraImageData.value = ""; // Clear camera data if file is dropped
            };
            reader.readAsDataURL(files[0]);
        }
    });

    uploadArea.addEventListener("click", function () {
        fileInput.click();
    });

    function captureImage() {
        if (videoPreview.videoWidth > 0 && videoPreview.videoHeight > 0) {
            canvas.width = videoPreview.videoWidth;
            canvas.height = videoPreview.videoHeight;
            context.drawImage(videoPreview, 0, 0, canvas.width, canvas.height);
            return canvas.toDataURL("image/jpeg");
        } else {
            console.error("Video dimensions are zero. Ensure the video stream is properly loaded.");
            return null;
        }
    }

    document.querySelector("form").addEventListener("submit", function (e) {
        if (captureCheckbox.checked) {
            e.preventDefault();

            const cameraData = captureImage();
            if (cameraData) {
                const formData = new FormData(this);
                formData.append('camera_image_data', cameraData);

                fetch(this.action, {
                    method: 'POST',
                    body: formData,
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = data.redirect_url; // Redirect to home or any other page
                    } else {
                        console.error("Form submission failed");
                    }
                })
                .catch(error => {
                    console.error("Error submitting form", error);
                });
            }
        }
    }); 
});

   
   
   </script>
    
    
    
  
  {% endblock %}
  